# IMO 会议文档分析 — 研究日志

## 项目概述
基于 IMO（国际海事组织）MEPC、MSC、CCC、SSE、ISWG-GHG 等委员会/工作组的会议提案文档，进行文本挖掘与政策分析。

**数据规模：**
- MEPC 77-83（7届海洋环境保护委员会会议）
- MSC 102-109（8届海上安全委员会会议）
- CCC 7-10（4届货物运输分委会）
- SSE 7-11（5届船舶系统与设备分委会）
- ISWG-GHG 16-18（3届温室气体减排工作组会议）
- 总计约 2870+ 篇提案/文档

**已完成模块：**
- [x] PDF 解析 + LLM 结构化提取
- [x] 文本相似度 & 引用网络分析
- [x] 词频统计 & TF-IDF
- [x] LDA 主题建模
- [x] 关键词共现网络（Louvain 社群发现）
- [x] 桑基图可视化（按议题/按国家）
- [x] 关键词趋势分析

---

## 2026-02-12

### 1. 桑基图显示 Bug 修复

**问题描述：**
- `topic_attention_sankey.py`（per-country sankey）中，议题标题被截断为 25 字符 + `...`，导致标签难以辨认（如 "REDUCTION OF GHG EMISSION..."）
- `sankey_trends.py` 中标签使用 `\n` 换行符，在 PNG 静态导出中渲染异常
- 两个脚本的桑基图都缺少会议名称轴标注，无法区分各列对应的会议
- `build_per_country_sankey` 中使用截断后的 `short_title` 作为 node_name 的 key，而链接构建也用截断标题匹配，当多个议题截断后相同时会产生碰撞

**修复方案：**
- 将标签中的标题截断阈值从 25 提升到 40 字符
- 将 `\n` 替换为 `<br>` 以适配 Plotly 渲染
- 在 node 内部名称中使用完整标题（而非截断），仅在 label 展示时截断
- 增加 x 轴会议名称标注（通过 annotations）
- 链接颜色从统一灰色改为按议题/国家着色以提高可读性

**修改文件：**
- `src/sankey_trends.py` — 标签换行符修复
- `src/topic_attention_sankey.py` — 标题截断、节点 key 碰撞、链接着色、会议标注

---

### 2. 国家立场网络分析（待完成）

**目标：** 利用提案的 Originator 共同提交关系，构建国家/组织间的合作网络图。

**方法：**
- 提取每篇文档的 Originator_split 字段
- 当一篇文档有多个提交方时，两两建立共现边
- 边权重 = 联合提案次数
- 使用 NetworkX 构建图，按议题分组对比
- Louvain 社群发现识别"联盟"结构
- 可视化：力导向图 + 社群着色

**预期输出：**
- `output/MEPC/alliance_network.png` — 总体合作网络
- `output/MEPC/alliance_network_GHG.png` — GHG 议题合作网络
- `output/MEPC/alliance_stats.json` — 统计数据

---

### 3. 文本相似度 & 引用网络分析（已完成 ✅）

**目标：** 分析文档间的文本相似关系和跨会议引用关系，追踪政策提案的演化路径。

**实现文件：** `src/citation_network.py`

**方法：**
- 正则提取文档间引用（MEPC/MSC/CCC/SSE/ISWG-GHG xx/x/x 格式）
- TF-IDF 向量化 + 余弦相似度矩阵
- 层次聚类（AgglomerativeClustering）发现文档群组
- 构建有向引用网络（NetworkX DiGraph）
- 识别高被引文档（hub documents）
- 基于议题分组 + 引用路径追踪提案演化链

**运行结果（2026-02-12）：**

| 委员会 | 文档数 | 节点数 | 引用边数 | 聚类数 | Top Hub |
|--------|--------|--------|----------|--------|---------|
| MEPC | 891 | 1065 | 805 | 30 | MEPC 80/17 (38次) |
| MSC | 854 | 934 | 656 | 30 | MSC 100/20 (25次) |
| CCC | 405 | 452 | 256 | 19 | CCC 9/4 (9次) |
| SSE | 355 | 425 | 342 | 17 | MSC 101/24 (15次) |
| ISWG-GHG | 88 | 140 | 113 | 5 | MEPC 81/16 (7次) |

**关键发现（MEPC）：**
- 最长演化链：30篇文档围绕 "HARMFUL AQUATIC ORGANISMS IN BALLAST WATER"
- GHG 减排议题有27篇文档的连续引用链
- 最相似文档对：MEPC 80/INF.11 ↔ MEPC 81/INF.7（相似度 1.0）
- Hub 文档主要是各届会议报告（MEPC xx/17 或 xx/16 系列）

**输出文件（每个委员会）：**
- `citation_network_{PREFIX}.png` — 静态引用网络图
- `citation_network_{PREFIX}.html` — 交互式 Plotly 引用网络
- `similarity_clusters_{PREFIX}.png` — 文档相似度热力图
- `citation_analysis_{PREFIX}.json` — 完整分析统计数据

**注意事项：**
- `json_read.load_data()` 会从 `content` 字段重建 `full_text`，导致 `data_processed.json` 中预存的 `full_text` 丢失。`citation_network.py` 直接读取原始 JSON 绕过此问题。

---

## 变更记录

| 日期 | 操作 | 文件 | 说明 |
|------|------|------|------|
| 2026-02-12 | 创建 | 研究日志.md | 初始化研究日志 |
| 2026-02-12 | 修复 | src/sankey_trends.py | 标签换行符 bug |
| 2026-02-12 | 修复 | src/topic_attention_sankey.py | 标题截断/节点碰撞/着色/标注 |
| 2026-02-12 | 新增 | src/alliance_network.py | 国家立场网络分析（已完成） |
| 2026-02-12 | 新增 | src/citation_network.py | 文本相似度 & 引用网络分析（已完成） |
